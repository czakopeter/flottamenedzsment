<!DOCTYPE html>
<html lang="en" layout:decorate="~{layouts/main}">
<head>
<title>Flotta</title>
</head>
<body>

  <div layout:fragment="loginContent">

    <h2>Invoices</h2>

    <div th:if="${error}" class="alert alert-danger" th:text="${error}"></div>

<!--     <div id="filter-wrapper" -->
<!--       style="background: #eee; width: auto; border-radius: .5rem; margin: 1em;" class="my-border" -->
<!--     > -->
<!--       <div id="filer-button-wrapper" style="text-align: center"> -->
<!--         <a href="#filter-options-wrapper1" class="collapsed" data-toggle="collapse" role="button" -->
<!--           aria-expanded="false" -->
<!--         >Filters1</a> -->
<!--       </div> -->
<!--       <div id="filter-options-wrapper1" class="collapse"> -->
<!--         <table class="table table-sm"> -->
<!--           <thead> -->
<!--             <tr> -->
<!--               <th th:text="#{bill.invoiceNumber}">Invoice number</th> -->
<!--               <th th:text="#{bill.fromDate}">From</th> -->
<!--               <th th:text="#{bill.emdDate}">To</th> -->
<!--               <th></th> -->
<!--             </tr> -->
<!--           </thead> -->
<!--           <tbody> -->
<!--             <tr> -->
<!--               <td name="invoiceNumber"><input id="invoice-number" type="text" -->
<!--                 class="form-control form-control-sm" -->
<!--               /></td> -->
<!--               <td><input id="begin-date" type="date" onchange="filterDateSet(this)" -->
<!--                 class="form-control  form-control-sm" -->
<!--               /></td> -->
<!--               <td><input id="end-date" type="date" onchange="filterDateSet(this)" -->
<!--                 class="form-control  form-control-sm" -->
<!--               /></td> -->
<!--               <td></td> -->
<!--               <td></td> -->
<!--               <td></td> -->
<!--             </tr> -->
<!--           </tbody> -->
<!--         </table> -->
<!--       </div> -->
<!--     </div> -->
    
    <div th:replace="fragments/filter :: filter-wrapper(invoice-filter-options)"></div>

    <form action="/invoice/fileUpload" method="post" enctype="multipart/form-data">
      <h4>Invoice upload</h4>
      <label for="fileBtn">Select an invoice: </label> <input type="file" id="file" name="file"
        accept=".xml" onchange="selectFile(this)" style="display: none"
      /> <input type="button" id=fileBtn onclick="browseFile()" class="btn btn-sm"
        th:value="Browse..."
      /> <label id="fileName">No file selected.</label> <input type="submit"
        class="btn btn-sm btn-primary" th:value="#{button.add}"
      />
    </form>

    <h4>Invoice tables</h4>
    <div th:if="${#lists.isEmpty(rawInvoices)}" class="my-border text-center">
      <b>There aren't any raw invoices</b>
    </div>

    <div th:unless="${#lists.isEmpty(rawInvoices)}">
      <form method="post">
        <table id="raw-invoice-table" class="table table-sm">
          <thead>
            <tr>
              <th th:text="#{bill.invoiceNumber}">Invoice number</th>
              <th th:text="#{bill.fromDate}">From</th>
              <th th:text="#{bill.emdDate}">To</th>
              <th th:text="#{bill.invoiceNetAmount}">Net amount</th>
              <th th:text="#{bill.invoiceGrossAmount}">Gross amount</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            <tr th:each="rawInvoice : ${rawInvoices}">
              <td name="invoiceNumber" th:text="${rawInvoice.invoiceNumber}"></td>
              <td th:text="${rawInvoice.beginDate}"></td>
              <td th:text="${rawInvoice.endDate}"></td>
              <td th:text="${rawInvoice.invoiceNetAmount}"></td>
              <td th:text="${rawInvoice.invoiceGrossAmount}"></td>
              <td><a href="#" class="dropdown" data-toggle="dropdown" role="button"
                aria-haspopup="true" aria-expanded="false"
              >...</a>
                <div class="dropdown-menu">
                  <a class="dropdown-item" href="#">1.</a> <a class="dropdown-item" href="#">2.</a>
                </div></td>
            </tr>
          </tbody>
        </table>
      </form>
    </div>


    <div th:if="${#lists.isEmpty(invoices)}" class="my-border text-center">
      <b>There aren't any invoices</b>
    </div>

    <div th:unless="${#lists.isEmpty(invoices)}">
      <form method="post">
        <table id="invoice-table" class="table table-sm">
          <thead>
            <tr>
              <th th:text="#{bill.invoiceNumber}">Invoice number</th>
              <th th:text="#{bill.fromDate}">From</th>
              <th th:text="#{bill.emdDate}">To</th>
              <th th:text="#{bill.invoiceNetAmount}">Net amount</th>
              <th th:text="#{bill.invoiceGrossAmount}">Gross amount</th>
              <th></th>
            </tr>
          </thead>
          <tr th:each="invoice : ${invoices}"
            th:classappend="${invoice.hasAnyRevisionNote() ? 'hasRevisionNote' : ''}"
          >
            <td name="invoiceNumber" th:text="${invoice.invoiceNumber}"></td>
            <td name="beginDate" th:text="${invoice.beginDate}"></td>
            <td name="endDate" th:text="${invoice.endDate}"></td>
            <td th:text="${invoice.invoiceNetAmount}"></td>
            <td th:text="${invoice.invoiceGrossAmount}"></td>
            <td>
              <button th:unless="${invoice.hasProblem() or invoice.acceptedByCompany}" type="submit"
                class="btn btn-sm btn-success"
                th:formaction="'/invoice/' + ${invoice.invoiceNumber} + '/accept'"
                th:title="#{button.accept}"
              >
                <img alt="Accept" src="/img/checkmark.png">
              </button> <a th:unless="${invoice.hasProblem()}"
              th:href="'/invoice/' + ${invoice.invoiceNumber} + '/details'"
              class="btn btn-sm btn-primary"
            > <img th:alt="#{button.details}" src="/img/list.png" />
            </a>
              <div class="btn-group">
                <button type="submit" class="btn btn-sm btn-warning"
                  th:formaction="'/invoice/' + ${invoice.invoiceNumber} + '/restartProcessing'"
                >
                  <img alt="refresh" src="/img/refresh.png" />
                </button>
                <button th:if="${invoice.canDelete()}" type="submit" class="btn btn-sm btn-danger"
                  th:formaction="'/invoice/' + ${invoice.invoiceNumber} + '/delete'"
                  th:title="#{button.delete}"
                >
                  <img alt="Delete" src="/img/trash.png" />
                </button>
              </div> <img th:if="${invoice.hasProblem()}" alt="Problem" src="/img/problem.png"
              th:title="${invoice.getProblem()}" style="height: 20px;"
            />
            </td>
          </tr>
        </table>
      </form>
    </div>
    <!--       <input type="hidden" id="template_id" name="template_id" /> -->



    <script src="/js/invoiceAll.js"></script>
    


  </div>
</body>
</html>